# AppArmor profile for replicaset-catalog-operator
profile replicaset-catalog-operator-profile flags=(attach_disconnected,mediate_deleted) {
  #include <tunables/global>
  # Executable: /bin/catalog
  /bin/catalog \{
    capability CHOWN,
    capability DAC_OVERRIDE,
    capability DAC_READ_SEARCH,
    capability NET_ADMIN,
    capability SETGID,
    capability SETPCAP,
    capability SETUID,
    capability SYS_ADMIN,
  }
  # Executable: /bin/grpc_health_probe
  /bin/grpc_health_probe \{
    capability CHOWN,
    capability DAC_OVERRIDE,
    capability DAC_READ_SEARCH,
    capability NET_ADMIN,
    capability SETGID,
    capability SETPCAP,
    capability SETUID,
    capability SYS_ADMIN,
  }
  # Executable: /bin/opm
  /bin/opm \{
    capability CHOWN,
    capability DAC_OVERRIDE,
    capability DAC_READ_SEARCH,
    capability NET_ADMIN,
    capability SETGID,
    capability SETPCAP,
    capability SETUID,
    capability SYS_ADMIN,
  }
}
