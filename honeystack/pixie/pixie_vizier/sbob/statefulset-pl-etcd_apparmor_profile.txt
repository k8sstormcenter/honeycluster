# AppArmor profile for statefulset-pl-etcd
profile statefulset-pl-etcd-profile flags=(attach_disconnected,mediate_deleted) {
  #include <tunables/global>
  # Executable: /bin/cut
  /bin/cut \{
    capability NET_ADMIN,
    capability NET_RAW,
    capability SETGID,
    capability SETPCAP,
    capability SETUID,
    capability SYS_ADMIN,
  }
  # Executable: /bin/grep
  /bin/grep \{
    capability NET_ADMIN,
    capability NET_RAW,
    capability SETGID,
    capability SETPCAP,
    capability SETUID,
    capability SYS_ADMIN,
  }
  # Executable: /bin/hostname
  /bin/hostname \{
    capability NET_ADMIN,
    capability NET_RAW,
    capability SETGID,
    capability SETPCAP,
    capability SETUID,
    capability SYS_ADMIN,
  }
  # Executable: /bin/ping
  /bin/ping \{
    capability NET_ADMIN,
    capability NET_RAW,
    capability SETGID,
    capability SETPCAP,
    capability SETUID,
    capability SYS_ADMIN,
  }
  # Executable: /bin/seq
  /bin/seq \{
    capability NET_ADMIN,
    capability NET_RAW,
    capability SETGID,
    capability SETPCAP,
    capability SETUID,
    capability SYS_ADMIN,
  }
  # Executable: /bin/wc
  /bin/wc \{
    capability NET_ADMIN,
    capability NET_RAW,
    capability SETGID,
    capability SETPCAP,
    capability SETUID,
    capability SYS_ADMIN,
  }
  # Executable: /etc/etcd/scripts/healthcheck.sh
  /etc/etcd/scripts/healthcheck.sh \{
    capability NET_ADMIN,
    capability NET_RAW,
    capability SETGID,
    capability SETPCAP,
    capability SETUID,
    capability SYS_ADMIN,
  }
  # Executable: /etc/etcd/scripts/run.sh
  /etc/etcd/scripts/run.sh \{
    capability NET_ADMIN,
    capability NET_RAW,
    capability SETGID,
    capability SETPCAP,
    capability SETUID,
    capability SYS_ADMIN,
  }
  # Executable: /usr/local/bin/etcd
  /usr/local/bin/etcd \{
    capability NET_ADMIN,
    capability NET_RAW,
    capability SETGID,
    capability SETPCAP,
    capability SETUID,
    capability SYS_ADMIN,
  }
  # Executable: /usr/local/bin/etcdctl
  /usr/local/bin/etcdctl \{
    capability NET_ADMIN,
    capability NET_RAW,
    capability SETGID,
    capability SETPCAP,
    capability SETUID,
    capability SYS_ADMIN,
  }
}
