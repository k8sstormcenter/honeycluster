apiVersion: cilium.io/v1alpha1
kind: TracingPolicy
metadata:
  name: detect-kubelet-pods-access
spec:
  kprobes:
  - call: "sys_openat"  
    syscall: true
    args:
    - index: 0
      type: "int"   
    - index: 1
      type: "string"
    - index: 2
      type: "int"
    selectors:
    - matchArgs:
        - index: 1 
          operator: "Postfix"  
          values:
            - "token"
            - "/proc/mounts"
      matchBinaries:
      - operator: "NotIn"
        values:
        - "/usr/bin/kubelet"
        - "/usr/local/sbin/runc"
        - "/usr/local/bin/containerd"
        - "/usr/local/bin/containerd-shim-runc-v2"

#{"process_kprobe":{"process":{"exec_id":"aG9uZXljbHVzdGVyLWNvbnRyb2wtcGxhbmU6MzIwNzg3MzA3NDE2Mjo0OTk0MQ==", "pid":49941, "uid":0, "cwd":"/", "binary":"/usr/bin/cat", "arguments":"/run/secrets/kubernetes.io/serviceaccount/token", "flags":"execve rootcwd clone inInitTree", "start_time":"2025-01-08T23:50:15.442349320Z", "auid":4294967295, "pod":{"namespace":"default", "name":"exploit-host-read-traverse-pod", "container":{"id":"containerd://0dc6abedcdf694ca0a72f4719302189109b27e7c5a93798934480ac3e93b6238", "name":"exploit-host-read-traverse-pod", "image":{"id":"docker.io/library/ubuntu@sha256:80dd3c3b9c6cecb9f1667e9290b3bc61b78c2678c02cbdae5f0fea92cc6734ab", "name":"docker.io/library/ubuntu:latest"}, "start_time":"2025-01-08T23:50:15Z", "pid":11}, "pod_labels":{"app":"kubehound-edge-test"}, "workload":"exploit-host-read-traverse-pod", "workload_kind":"Pod"}, "docker":"0dc6abedcdf694ca0a72f4719302189", "parent_exec_id":"aG9uZXljbHVzdGVyLWNvbnRyb2wtcGxhbmU6MzIwNzg3MDMwMzk5Nzo0OTkyNA==", "refcnt":1, "tid":49941, "in_init_tree":true}, "parent":{"exec_id":"aG9uZXljbHVzdGVyLWNvbnRyb2wtcGxhbmU6MzIwNzg3MDMwMzk5Nzo0OTkyNA==", "pid":49924, "uid":0, "cwd":"/", "binary":"/bin/sh", "arguments":"-c -- \"cat /proc/mounts && cat /run/secrets/kubernetes.io/serviceaccount/token && sleep infinity\"", "flags":"execve rootcwd clone inInitTree", "start_time":"2025-01-08T23:50:15.439579254Z", "auid":4294967295, "pod":{"namespace":"default", "name":"exploit-host-read-traverse-pod", "container":{"id":"containerd://0dc6abedcdf694ca0a72f4719302189109b27e7c5a93798934480ac3e93b6238", "name":"exploit-host-read-traverse-pod", "image":{"id":"docker.io/library/ubuntu@sha256:80dd3c3b9c6cecb9f1667e9290b3bc61b78c2678c02cbdae5f0fea92cc6734ab", "name":"docker.io/library/ubuntu:latest"}, "start_time":"2025-01-08T23:50:15Z", "pid":1}, "pod_labels":{"app":"kubehound-edge-test"}, "workload":"exploit-host-read-traverse-pod", "workload_kind":"Pod"}, "docker":"0dc6abedcdf694ca0a72f4719302189", "parent_exec_id":"aG9uZXljbHVzdGVyLWNvbnRyb2wtcGxhbmU6MzIwNjU1NjM2MzA3NDo0OTgzMQ==", "tid":49924, "in_init_tree":true}, "function_name":"security_file_permission", "args":[{"file_arg":{"path":"/run/secrets/kubernetes.io/serviceaccount/..2025_01_08_23_50_13.1551107727/token", "permission":"-rw-r--r--"}}, {"int_arg":4}], "return":{"int_arg":0}, "action":"KPROBE_ACTION_POST", "policy_name":"enumerate-service-account", "return_action":"KPROBE_ACTION_POST"}, "node_name":"honeycluster-control-plane", "time":"2025-01-08T23:50:15.443113975Z"}
#{"process_kprobe":{"process":{"exec_id":"aG9uZXljbHVzdGVyLWNvbnRyb2wtcGxhbmU6MzIwNzg3MzA3NDE2Mjo0OTk0MQ==", "pid":49941, "uid":0, "cwd":"/", "binary":"/usr/bin/cat", "arguments":"/run/secrets/kubernetes.io/serviceaccount/token", "flags":"execve rootcwd clone inInitTree", "start_time":"2025-01-08T23:50:15.442349320Z", "auid":4294967295, "pod":{"namespace":"default", "name":"exploit-host-read-traverse-pod", "container":{"id":"containerd://0dc6abedcdf694ca0a72f4719302189109b27e7c5a93798934480ac3e93b6238", "name":"exploit-host-read-traverse-pod", "image":{"id":"docker.io/library/ubuntu@sha256:80dd3c3b9c6cecb9f1667e9290b3bc61b78c2678c02cbdae5f0fea92cc6734ab", "name":"docker.io/library/ubuntu:latest"}, "start_time":"2025-01-08T23:50:15Z", "pid":11}, "pod_labels":{"app":"kubehound-edge-test"}, "workload":"exploit-host-read-traverse-pod", "workload_kind":"Pod"}, "docker":"0dc6abedcdf694ca0a72f4719302189", "parent_exec_id":"aG9uZXljbHVzdGVyLWNvbnRyb2wtcGxhbmU6MzIwNzg3MDMwMzk5Nzo0OTkyNA==", "refcnt":1, "tid":49941, "in_init_tree":true}, "parent":{"exec_id":"aG9uZXljbHVzdGVyLWNvbnRyb2wtcGxhbmU6MzIwNzg3MDMwMzk5Nzo0OTkyNA==", "pid":49924, "uid":0, "cwd":"/", "binary":"/bin/sh", "arguments":"-c -- \"cat /proc/mounts && cat /run/secrets/kubernetes.io/serviceaccount/token && sleep infinity\"", "flags":"execve rootcwd clone inInitTree", "start_time":"2025-01-08T23:50:15.439579254Z", "auid":4294967295, "pod":{"namespace":"default", "name":"exploit-host-read-traverse-pod", "container":{"id":"containerd://0dc6abedcdf694ca0a72f4719302189109b27e7c5a93798934480ac3e93b6238", "name":"exploit-host-read-traverse-pod", "image":{"id":"docker.io/library/ubuntu@sha256:80dd3c3b9c6cecb9f1667e9290b3bc61b78c2678c02cbdae5f0fea92cc6734ab", "name":"docker.io/library/ubuntu:latest"}, "start_time":"2025-01-08T23:50:15Z", "pid":1}, "pod_labels":{"app":"kubehound-edge-test"}, "workload":"exploit-host-read-traverse-pod", "workload_kind":"Pod"}, "docker":"0dc6abedcdf694ca0a72f4719302189", "parent_exec_id":"aG9uZXljbHVzdGVyLWNvbnRyb2wtcGxhbmU6MzIwNjU1NjM2MzA3NDo0OTgzMQ==", "tid":49924, "in_init_tree":true}, "function_name":"security_file_permission", "args":[{"file_arg":{"path":"/run/secrets/kubernetes.io/serviceaccount/..2025_01_08_23_50_13.1551107727/token", "permission":"-rw-r--r--"}}, {"int_arg":4}], "return":{"int_arg":0}, "action":"KPROBE_ACTION_POST", "policy_name":"enumerate-service-account", "return_action":"KPROBE_ACTION_POST"}, "node_name":"honeycluster-control-plane", "time":"2025-01-08T23:50:15.443245423Z"}
#{"process_kprobe":{"process":{"exec_id":"aG9uZXljbHVzdGVyLWNvbnRyb2wtcGxhbmU6MzY5NDczNzg1Mzg5Mzo1NzE0MA==", "pid":57140, "uid":0, "cwd":"/", "binary":"/usr/bin/cat", "arguments":"/proc/mounts", "flags":"execve rootcwd clone inInitTree", "start_time":"2025-01-08T23:58:22.314412873Z", "auid":4294967295, "pod":{"namespace":"default", "name":"exploit-host-read-traverse-pod", "container":{"id":"containerd://acc92912660ee99b66aa94f940bd3ce02e539bbee757021acff66a049e5c0926", "name":"exploit-host-read-traverse-pod", "image":{"id":"docker.io/library/ubuntu@sha256:80dd3c3b9c6cecb9f1667e9290b3bc61b78c2678c02cbdae5f0fea92cc6734ab", "name":"docker.io/library/ubuntu:latest"}, "start_time":"2025-01-08T23:58:22Z", "pid":10}, "pod_labels":{"app":"kubehound-edge-test"}, "workload":"exploit-host-read-traverse-pod", "workload_kind":"Pod"}, "docker":"acc92912660ee99b66aa94f940bd3ce", "parent_exec_id":"aG9uZXljbHVzdGVyLWNvbnRyb2wtcGxhbmU6MzY5NDczNjQ2OTYzODo1NzEyNQ==", "refcnt":1, "tid":57140, "in_init_tree":true}, "parent":{"exec_id":"aG9uZXljbHVzdGVyLWNvbnRyb2wtcGxhbmU6MzY5NDczNjQ2OTYzODo1NzEyNQ==", "pid":57125, "uid":0, "cwd":"/", "binary":"/bin/sh", "arguments":"-c -- \"cat /proc/mounts && cat /run/secrets/kubernetes.io/serviceaccount/token && cat /hostpods/**/volumes/kubernetes.io~projected/**/token && sleep infinity\"", "flags":"execve rootcwd clone inInitTree", "start_time":"2025-01-08T23:58:22.313028820Z", "auid":4294967295, "pod":{"namespace":"default", "name":"exploit-host-read-traverse-pod", "container":{"id":"containerd://acc92912660ee99b66aa94f940bd3ce02e539bbee757021acff66a049e5c0926", "name":"exploit-host-read-traverse-pod", "image":{"id":"docker.io/library/ubuntu@sha256:80dd3c3b9c6cecb9f1667e9290b3bc61b78c2678c02cbdae5f0fea92cc6734ab", "name":"docker.io/library/ubuntu:latest"}, "start_time":"2025-01-08T23:58:22Z", "pid":1}, "pod_labels":{"app":"kubehound-edge-test"}, "workload":"exploit-host-read-traverse-pod", "workload_kind":"Pod"}, "docker":"acc92912660ee99b66aa94f940bd3ce", "parent_exec_id":"aG9uZXljbHVzdGVyLWNvbnRyb2wtcGxhbmU6MzY5Mjg5NzQ5NjU3Njo1NzA3Ng==", "tid":57125, "in_init_tree":true}, "function_name":"__x64_sys_openat", "args":[{"string_arg":"/proc/mounts"}, {"int_arg":0}], "action":"KPROBE_ACTION_POST", "policy_name":"detect-kubelet-pods-access", "return_action":"KPROBE_ACTION_POST"}, "node_name":"honeycluster-control-plane", "time":"2025-01-08T23:58:22.315063894Z"}
#{"process_kprobe":{"process":{"exec_id":"aG9uZXljbHVzdGVyLWNvbnRyb2wtcGxhbmU6MzY5NDczOTM0MTU3NTo1NzE0MQ==", "pid":57141, "uid":0, "cwd":"/", "binary":"/usr/bin/cat", "arguments":"/run/secrets/kubernetes.io/serviceaccount/token", "flags":"execve rootcwd clone inInitTree", "start_time":"2025-01-08T23:58:22.315900620Z", "auid":4294967295, "pod":{"namespace":"default", "name":"exploit-host-read-traverse-pod", "container":{"id":"containerd://acc92912660ee99b66aa94f940bd3ce02e539bbee757021acff66a049e5c0926", "name":"exploit-host-read-traverse-pod", "image":{"id":"docker.io/library/ubuntu@sha256:80dd3c3b9c6cecb9f1667e9290b3bc61b78c2678c02cbdae5f0fea92cc6734ab", "name":"docker.io/library/ubuntu:latest"}, "start_time":"2025-01-08T23:58:22Z", "pid":11}, "pod_labels":{"app":"kubehound-edge-test"}, "workload":"exploit-host-read-traverse-pod", "workload_kind":"Pod"}, "docker":"acc92912660ee99b66aa94f940bd3ce", "parent_exec_id":"aG9uZXljbHVzdGVyLWNvbnRyb2wtcGxhbmU6MzY5NDczNjQ2OTYzODo1NzEyNQ==", "refcnt":1, "tid":57141, "in_init_tree":true}, "parent":{"exec_id":"aG9uZXljbHVzdGVyLWNvbnRyb2wtcGxhbmU6MzY5NDczNjQ2OTYzODo1NzEyNQ==", "pid":57125, "uid":0, "cwd":"/", "binary":"/bin/sh", "arguments":"-c -- \"cat /proc/mounts && cat /run/secrets/kubernetes.io/serviceaccount/token && cat /hostpods/**/volumes/kubernetes.io~projected/**/token && sleep infinity\"", "flags":"execve rootcwd clone inInitTree", "start_time":"2025-01-08T23:58:22.313028820Z", "auid":4294967295, "pod":{"namespace":"default", "name":"exploit-host-read-traverse-pod", "container":{"id":"containerd://acc92912660ee99b66aa94f940bd3ce02e539bbee757021acff66a049e5c0926", "name":"exploit-host-read-traverse-pod", "image":{"id":"docker.io/library/ubuntu@sha256:80dd3c3b9c6cecb9f1667e9290b3bc61b78c2678c02cbdae5f0fea92cc6734ab", "name":"docker.io/library/ubuntu:latest"}, "start_time":"2025-01-08T23:58:22Z", "pid":1}, "pod_labels":{"app":"kubehound-edge-test"}, "workload":"exploit-host-read-traverse-pod", "workload_kind":"Pod"}, "docker":"acc92912660ee99b66aa94f940bd3ce", "parent_exec_id":"aG9uZXljbHVzdGVyLWNvbnRyb2wtcGxhbmU6MzY5Mjg5NzQ5NjU3Njo1NzA3Ng==", "tid":57125, "in_init_tree":true}, "function_name":"__x64_sys_openat", "args":[{"string_arg":"/run/secrets/kubernetes.io/serviceaccount/token"}, {"int_arg":0}], "action":"KPROBE_ACTION_POST", "policy_name":"detect-kubelet-pods-access", "return_action":"KPROBE_ACTION_POST"}, "node_name":"honeycluster-control-plane", "time":"2025-01-08T23:58:22.316416970Z"}
#{"process_kprobe":{"process":{"exec_id":"aG9uZXljbHVzdGVyLWNvbnRyb2wtcGxhbmU6MzY5NDczOTM0MTU3NTo1NzE0MQ==", "pid":57141, "uid":0, "cwd":"/", "binary":"/usr/bin/cat", "arguments":"/run/secrets/kubernetes.io/serviceaccount/token", "flags":"execve rootcwd clone inInitTree", "start_time":"2025-01-08T23:58:22.315900620Z", "auid":4294967295, "pod":{"namespace":"default", "name":"exploit-host-read-traverse-pod", "container":{"id":"containerd://acc92912660ee99b66aa94f940bd3ce02e539bbee757021acff66a049e5c0926", "name":"exploit-host-read-traverse-pod", "image":{"id":"docker.io/library/ubuntu@sha256:80dd3c3b9c6cecb9f1667e9290b3bc61b78c2678c02cbdae5f0fea92cc6734ab", "name":"docker.io/library/ubuntu:latest"}, "start_time":"2025-01-08T23:58:22Z", "pid":11}, "pod_labels":{"app":"kubehound-edge-test"}, "workload":"exploit-host-read-traverse-pod", "workload_kind":"Pod"}, "docker":"acc92912660ee99b66aa94f940bd3ce", "parent_exec_id":"aG9uZXljbHVzdGVyLWNvbnRyb2wtcGxhbmU6MzY5NDczNjQ2OTYzODo1NzEyNQ==", "refcnt":1, "tid":57141, "in_init_tree":true}, "parent":{"exec_id":"aG9uZXljbHVzdGVyLWNvbnRyb2wtcGxhbmU6MzY5NDczNjQ2OTYzODo1NzEyNQ==", "pid":57125, "uid":0, "cwd":"/", "binary":"/bin/sh", "arguments":"-c -- \"cat /proc/mounts && cat /run/secrets/kubernetes.io/serviceaccount/token && cat /hostpods/**/volumes/kubernetes.io~projected/**/token && sleep infinity\"", "flags":"execve rootcwd clone inInitTree", "start_time":"2025-01-08T23:58:22.313028820Z", "auid":4294967295, "pod":{"namespace":"default", "name":"exploit-host-read-traverse-pod", "container":{"id":"containerd://acc92912660ee99b66aa94f940bd3ce02e539bbee757021acff66a049e5c0926", "name":"exploit-host-read-traverse-pod", "image":{"id":"docker.io/library/ubuntu@sha256:80dd3c3b9c6cecb9f1667e9290b3bc61b78c2678c02cbdae5f0fea92cc6734ab", "name":"docker.io/library/ubuntu:latest"}, "start_time":"2025-01-08T23:58:22Z", "pid":1}, "pod_labels":{"app":"kubehound-edge-test"}, "workload":"exploit-host-read-traverse-pod", "workload_kind":"Pod"}, "docker":"acc92912660ee99b66aa94f940bd3ce", "parent_exec_id":"aG9uZXljbHVzdGVyLWNvbnRyb2wtcGxhbmU6MzY5Mjg5NzQ5NjU3Njo1NzA3Ng==", "tid":57125, "in_init_tree":true}, "function_name":"security_file_permission", "args":[{"file_arg":{"path":"/run/secrets/kubernetes.io/serviceaccount/..2025_01_08_23_58_20.3773324814/token", "permission":"-rw-r--r--"}}, {"int_arg":4}], "return":{"int_arg":0}, "action":"KPROBE_ACTION_POST", "policy_name":"enumerate-service-account", "return_action":"KPROBE_ACTION_POST"}, "node_name":"honeycluster-control-plane", "time":"2025-01-08T23:58:22.316488522Z"}
#{"process_kprobe":{"process":{"exec_id":"aG9uZXljbHVzdGVyLWNvbnRyb2wtcGxhbmU6MzY5NDczOTM0MTU3NTo1NzE0MQ==", "pid":57141, "uid":0, "cwd":"/", "binary":"/usr/bin/cat", "arguments":"/run/secrets/kubernetes.io/serviceaccount/token", "flags":"execve rootcwd clone inInitTree", "start_time":"2025-01-08T23:58:22.315900620Z", "auid":4294967295, "pod":{"namespace":"default", "name":"exploit-host-read-traverse-pod", "container":{"id":"containerd://acc92912660ee99b66aa94f940bd3ce02e539bbee757021acff66a049e5c0926", "name":"exploit-host-read-traverse-pod", "image":{"id":"docker.io/library/ubuntu@sha256:80dd3c3b9c6cecb9f1667e9290b3bc61b78c2678c02cbdae5f0fea92cc6734ab", "name":"docker.io/library/ubuntu:latest"}, "start_time":"2025-01-08T23:58:22Z", "pid":11}, "pod_labels":{"app":"kubehound-edge-test"}, "workload":"exploit-host-read-traverse-pod", "workload_kind":"Pod"}, "docker":"acc92912660ee99b66aa94f940bd3ce", "parent_exec_id":"aG9uZXljbHVzdGVyLWNvbnRyb2wtcGxhbmU6MzY5NDczNjQ2OTYzODo1NzEyNQ==", "refcnt":1, "tid":57141, "in_init_tree":true}, "parent":{"exec_id":"aG9uZXljbHVzdGVyLWNvbnRyb2wtcGxhbmU6MzY5NDczNjQ2OTYzODo1NzEyNQ==", "pid":57125, "uid":0, "cwd":"/", "binary":"/bin/sh", "arguments":"-c -- \"cat /proc/mounts && cat /run/secrets/kubernetes.io/serviceaccount/token && cat /hostpods/**/volumes/kubernetes.io~projected/**/token && sleep infinity\"", "flags":"execve rootcwd clone inInitTree", "start_time":"2025-01-08T23:58:22.313028820Z", "auid":4294967295, "pod":{"namespace":"default", "name":"exploit-host-read-traverse-pod", "container":{"id":"containerd://acc92912660ee99b66aa94f940bd3ce02e539bbee757021acff66a049e5c0926", "name":"exploit-host-read-traverse-pod", "image":{"id":"docker.io/library/ubuntu@sha256:80dd3c3b9c6cecb9f1667e9290b3bc61b78c2678c02cbdae5f0fea92cc6734ab", "name":"docker.io/library/ubuntu:latest"}, "start_time":"2025-01-08T23:58:22Z", "pid":1}, "pod_labels":{"app":"kubehound-edge-test"}, "workload":"exploit-host-read-traverse-pod", "workload_kind":"Pod"}, "docker":"acc92912660ee99b66aa94f940bd3ce", "parent_exec_id":"aG9uZXljbHVzdGVyLWNvbnRyb2wtcGxhbmU6MzY5Mjg5NzQ5NjU3Njo1NzA3Ng==", "tid":57125, "in_init_tree":true}, "function_name":"security_file_permission", "args":[{"file_arg":{"path":"/run/secrets/kubernetes.io/serviceaccount/..2025_01_08_23_58_20.3773324814/token", "permission":"-rw-r--r--"}}, {"int_arg":4}], "return":{"int_arg":0}, "action":"KPROBE_ACTION_POST", "policy_name":"enumerate-service-account", "return_action":"KPROBE_ACTION_POST"}, "node_name":"honeycluster-control-plane", "time":"2025-01-08T23:58:22.316767741Z"}
#{"process_kprobe":{"process":{"exec_id":"aG9uZXljbHVzdGVyLWNvbnRyb2wtcGxhbmU6MzY5NDc0MTM1NTEzNTo1NzE0Mg==", "pid":57142, "uid":0, "cwd":"/", "binary":"/usr/bin/cat", "arguments":"/hostpods/09bfae0d-712f-49d1-99c3-5c9c495a2904/volumes/kubernetes.io~projected/kube-api-access-z2rw8/token /hostpods/17f9eee4-8827-4465-a1b0-d69f0ba2513b/volumes/kubernetes.io~projected/kube-api-access-q9qb4/token /hostpods/1ad6ac8f-51ce-4cb5-9fdc-5ea3c70e69d7/volumes/kubernetes.io~projected/kube-api-access-f4pww/token /hostpods/330f7ed6-d4e3-4942-8b24-a2cdb0a2416a/volumes/kubernetes.io~projected/kube-api-access-q9slg/token /hostpods/389a51d3-da58-4146-8bf1-273e71fbd7eb/volumes/kubernetes.io~projected/kube-api-access-q2l2h/token /hostpods/3ded8a3e-747e-43ad-8119-92cc7060c0b6/volumes/kubernetes.io~projected/kube-api-access-wqw7j/token /hostpods/47545e1e-da0b-4e6c-b97e-dd8cf0dd9bcd/volumes/kubernetes.io~projected/kube-api-access-ktw5f/token /hostpods/4ae6562c-d91c-4b9d-ae06-8e75822e66a5/volumes/kubernetes.io~projected/kube-api-access-dzhwz/token /hostpods/53271e5c-e92a-43fb-b005-850ae9c60280/volumes/kubernetes.io~projected/kube-api-access-df957/token /hostpods/732128e0-138c-4cd1-8334-aee4707e7310/volumes/kubernetes.io~projected/kube-api-access-4smpw/token /hostpods/78b64c2f-8ce7-44b0-806b-1b25c0d5d16f/volumes/kubernetes.io~projected/kube-api-access-k6lxr/token /hostpods/8f193e66-2bae-445a-b138-5f1459f21dfa/volumes/kubernetes.io~projected/kube-api-access-s9p9t/token /hostpods/ad5044af-e09b-4ac3-af16-f5ffeb84518f/volumes/kubernetes.io~projected/kube-api-access-dbg47/token /hostpods/ba7bb598-9970-4939-8b45-aa7c084270ae/volumes/kubernetes.io~projected/kube-api-access-7vt8f/token /hostpods/cc1dbe1e-9f3c-4bc7-9af6-e4e3a2acbfff/volumes/kubernetes.io~projected/kube-api-access-b7qlg/token", "flags":"execve rootcwd clone dataArgs inInitTree", "start_time":"2025-01-08T23:58:22.317914244Z", "auid":4294967295, "pod":{"namespace":"default", "name":"exploit-host-read-traverse-pod", "container":{"id":"containerd://acc92912660ee99b66aa94f940bd3ce02e539bbee757021acff66a049e5c0926", "name":"exploit-host-read-traverse-pod", "image":{"id":"docker.io/library/ubuntu@sha256:80dd3c3b9c6cecb9f1667e9290b3bc61b78c2678c02cbdae5f0fea92cc6734ab", "name":"docker.io/library/ubuntu:latest"}, "start_time":"2025-01-08T23:58:22Z", "pid":12}, "pod_labels":{"app":"kubehound-edge-test"}, "workload":"exploit-host-read-traverse-pod", "workload_kind":"Pod"}, "docker":"acc92912660ee99b66aa94f940bd3ce", "parent_exec_id":"aG9uZXljbHVzdGVyLWNvbnRyb2wtcGxhbmU6MzY5NDczNjQ2OTYzODo1NzEyNQ==", "refcnt":1, "tid":57142, "in_init_tree":true}, "parent":{"exec_id":"aG9uZXljbHVzdGVyLWNvbnRyb2wtcGxhbmU6MzY5NDczNjQ2OTYzODo1NzEyNQ==", "pid":57125, "uid":0, "cwd":"/", "binary":"/bin/sh", "arguments":"-c -- \"cat /proc/mounts && cat /run/secrets/kubernetes.io/serviceaccount/token && cat /hostpods/**/volumes/kubernetes.io~projected/**/token && sleep infinity\"", "flags":"execve rootcwd clone inInitTree", "start_time":"2025-01-08T23:58:22.313028820Z", "auid":4294967295, "pod":{"namespace":"default", "name":"exploit-host-read-traverse-pod", "container":{"id":"containerd://acc92912660ee99b66aa94f940bd3ce02e539bbee757021acff66a049e5c0926", "name":"exploit-host-read-traverse-pod", "image":{"id":"docker.io/library/ubuntu@sha256:80dd3c3b9c6cecb9f1667e9290b3bc61b78c2678c02cbdae5f0fea92cc6734ab", "name":"docker.io/library/ubuntu:latest"}, "start_time":"2025-01-08T23:58:22Z", "pid":1}, "pod_labels":{"app":"kubehound-edge-test"}, "workload":"exploit-host-read-traverse-pod", "workload_kind":"Pod"}, "docker":"acc92912660ee99b66aa94f940bd3ce", "parent_exec_id":"aG9uZXljbHVzdGVyLWNvbnRyb2wtcGxhbmU6MzY5Mjg5NzQ5NjU3Njo1NzA3Ng==", "tid":57125, "in_init_tree":true}, "function_name":"__x64_sys_openat", "args":[{"string_arg":"/hostpods/09bfae0d-712f-49d1-99c3-5c9c495a2904/volumes/kubernetes.io~projected/kube-api-access-z2rw8/token"}, {"int_arg":0}], "action":"KPROBE_ACTION_POST", "policy_name":"detect-kubelet-pods-access", "return_action":"KPROBE_ACTION_POST"}, "node_name":"honeycluster-control-plane", "time":"2025-01-08T23:58:22.318509414Z"}
#{"process_kprobe":{"process":{"exec_id":"aG9uZXljbHVzdGVyLWNvbnRyb2wtcGxhbmU6MzY5NDc0MTM1NTEzNTo1NzE0Mg==", "pid":57142, "uid":0, "cwd":"/", "binary":"/usr/bin/cat", "arguments":"/hostpods/09bfae0d-712f-49d1-99c3-5c9c495a2904/volumes/kubernetes.io~projected/kube-api-access-z2rw8/token /hostpods/17f9eee4-8827-4465-a1b0-d69f0ba2513b/volumes/kubernetes.io~projected/kube-api-access-q9qb4/token /hostpods/1ad6ac8f-51ce-4cb5-9fdc-5ea3c70e69d7/volumes/kubernetes.io~projected/kube-api-access-f4pww/token /hostpods/330f7ed6-d4e3-4942-8b24-a2cdb0a2416a/volumes/kubernetes.io~projected/kube-api-access-q9slg/token /hostpods/389a51d3-da58-4146-8bf1-273e71fbd7eb/volumes/kubernetes.io~projected/kube-api-access-q2l2h/token /hostpods/3ded8a3e-747e-43ad-8119-92cc7060c0b6/volumes/kubernetes.io~projected/kube-api-access-wqw7j/token /hostpods/47545e1e-da0b-4e6c-b97e-dd8cf0dd9bcd/volumes/kubernetes.io~projected/kube-api-access-ktw5f/token /hostpods/4ae6562c-d91c-4b9d-ae06-8e75822e66a5/volumes/kubernetes.io~projected/kube-api-access-dzhwz/token /hostpods/53271e5c-e92a-43fb-b005-850ae9c60280/volumes/kubernetes.io~projected/kube-api-access-df957/token /hostpods/732128e0-138c-4cd1-8334-aee4707e7310/volumes/kubernetes.io~projected/kube-api-access-4smpw/token /hostpods/78b64c2f-8ce7-44b0-806b-1b25c0d5d16f/volumes/kubernetes.io~projected/kube-api-access-k6lxr/token /hostpods/8f193e66-2bae-445a-b138-5f1459f21dfa/volumes/kubernetes.io~projected/kube-api-access-s9p9t/token /hostpods/ad5044af-e09b-4ac3-af16-f5ffeb84518f/volumes/kubernetes.io~projected/kube-api-access-dbg47/token /hostpods/ba7bb598-9970-4939-8b45-aa7c084270ae/volumes/kubernetes.io~projected/kube-api-access-7vt8f/token /hostpods/cc1dbe1e-9f3c-4bc7-9af6-e4e3a2acbfff/volumes/kubernetes.io~projected/kube-api-access-b7qlg/token", "flags":"execve rootcwd clone dataArgs inInitTree", "start_time":"2025-01-08T23:58:22.317914244Z", "auid":4294967295, "pod":{"namespace":"default", "name":"exploit-host-read-traverse-pod", "container":{"id":"containerd://acc92912660ee99b66aa94f940bd3ce02e539bbee757021acff66a049e5c0926", "name":"exploit-host-read-traverse-pod", "image":{"id":"docker.io/library/ubuntu@sha256:80dd3c3b9c6cecb9f1667e9290b3bc61b78c2678c02cbdae5f0fea92cc6734ab", "name":"docker.io/library/ubuntu:latest"}, "start_time":"2025-01-08T23:58:22Z", "pid":12}, "pod_labels":{"app":"kubehound-edge-test"}, "workload":"exploit-host-read-traverse-pod", "workload_kind":"Pod"}, "docker":"acc92912660ee99b66aa94f940bd3ce", "parent_exec_id":"aG9uZXljbHVzdGVyLWNvbnRyb2wtcGxhbmU6MzY5NDczNjQ2OTYzODo1NzEyNQ==", "refcnt":1, "tid":57142, "in_init_tree":true}, "parent":{"exec_id":"aG9uZXljbHVzdGVyLWNvbnRyb2wtcGxhbmU6MzY5NDczNjQ2OTYzODo1NzEyNQ==", "pid":57125, "uid":0, "cwd":"/", "binary":"/bin/sh", "arguments":"-c -- \"cat /proc/mounts && cat /run/secrets/kubernetes.io/serviceaccount/token && cat /hostpods/**/volumes/kubernetes.io~projected/**/token && sleep infinity\"", "flags":"execve rootcwd clone inInitTree", "start_time":"2025-01-08T23:58:22.313028820Z", "auid":4294967295, "pod":{"namespace":"default", "name":"exploit-host-read-traverse-pod", "container":{"id":"containerd://acc92912660ee99b66aa94f940bd3ce02e539bbee757021acff66a049e5c0926", "name":"exploit-host-read-traverse-pod", "image":{"id":"docker.io/library/ubuntu@sha256:80dd3c3b9c6cecb9f1667e9290b3bc61b78c2678c02cbdae5f0fea92cc6734ab", "name":"docker.io/library/ubuntu:latest"}, "start_time":"2025-01-08T23:58:22Z", "pid":1}, "pod_labels":{"app":"kubehound-edge-test"}, "workload":"exploit-host-read-traverse-pod", "workload_kind":"Pod"}, "docker":"acc92912660ee99b66aa94f940bd3ce", "parent_exec_id":"aG9uZXljbHVzdGVyLWNvbnRyb2wtcGxhbmU6MzY5Mjg5NzQ5NjU3Njo1NzA3Ng==", "tid":57125, "in_init_tree":true}, "function_name":"__x64_sys_openat", "args":[{"string_arg":"/hostpods/17f9eee4-8827-4465-a1b0-d69f0ba2513b/volumes/kubernetes.io~projected/kube-api-access-q9qb4/token"}, {"int_arg":0}], "action":"KPROBE_ACTION_POST", "policy_name":"detect-kubelet-pods-access", "return_action":"KPROBE_ACTION_POST"}, "node_name":"honeycluster-control-plane", "time":"2025-01-08T23:58:22.318814978Z"}